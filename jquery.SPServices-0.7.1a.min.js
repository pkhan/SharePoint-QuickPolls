/*
 * SPServices - Work with SharePoint's Web Services using jQuery
 * Version 0.7.1a
 * @requires jQuery v1.4.2 or greater - jQuery 1.7+ recommended
 *
 * Copyright (c) 2009-2012 Sympraxis Consulting LLC
 * Examples and docs at:
 * http://spservices.codeplex.com
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/mit-license.php
 */
/**
 * @description Work with SharePoint's Web Services using jQuery
 * @type jQuery
 * @name SPServices
 * @category Plugins/SPServices
 * @author Sympraxis Consulting LLC/marc.anderson@sympraxisconsulting.com
 */
(function(Q){var k="/";var Z="Column not found on page";var q="Alerts";var p="Authentication";var w="Copy";var aa="Forms";var r="Lists";var W="Meetings";var e="People";var b="Permissions";var z="PublishedLinksService";var J="Search";var C="SiteData";var ac="SocialDataService";var ak="TaxonomyClientService";var X="usergroup";var U="UserProfileService";var an="Versions";var n="Views";var P="WebPartPages";var v="Webs";var d="Workflow";var f="";var x="";var aj=0;var ab="";var V=[];V.GetAlerts=[q,false];V.DeleteAlerts=[q,true];V.Mode=[p,false];V.Login=[p,false];V.CopyIntoItems=[w,true];V.CopyIntoItemsLocal=[w,true];V.GetItem=[w,false];V.GetForm=[aa,false];V.GetFormCollection=[aa,false];V.AddAttachment=[r,true];V.AddList=[r,true];V.ApplyContentTypeToList=[r,true];V.CheckInFile=[r,true];V.CheckOutFile=[r,true];V.CreateContentType=[r,true];V.DeleteContentType=[r,true];V.DeleteAttachment=[r,true];V.DeleteList=[r,true];V.GetAttachmentCollection=[r,false];V.GetList=[r,false];V.GetListAndView=[r,false];V.GetListCollection=[r,false];V.GetListContentType=[r,false];V.GetListContentTypes=[r,false];V.GetListItems=[r,false];V.GetListItemChanges=[r,false];V.GetVersionCollection=[r,false];V.UndoCheckOut=[r,true];V.UpdateContentType=[r,true];V.UpdateList=[r,true];V.UpdateListItems=[r,true];V.AddMeeting=[W,true];V.CreateWorkspace=[W,true];V.RemoveMeeting=[W,true];V.SetWorkSpaceTitle=[W,true];V.SearchPrincipals=[e,false];V.AddPermission=[b,true];V.AddPermissionCollection=[b,true];V.GetPermissionCollection=[b,true];V.RemovePermission=[b,true];V.RemovePermissionCollection=[b,true];V.UpdatePermission=[b,true];V.GetLinks=[z,true];V.GetPortalSearchInfo=[J,false];V.GetQuerySuggestions=[J,false];V.GetSearchMetadata=[J,false];V.Query=[J,false];V.QueryEx=[J,false];V.Registration=[J,false];V.Status=[J,false];V.GetAttachments=[C,false];V.EnumerateFolder=[C,false];V.SiteDataGetList=[C,false];V.SiteDataGetListCollection=[C,false];V.SiteDataGetSite=[C,false];V.SiteDataGetSiteUrl=[C,false];V.SiteDataGetWeb=[C,false];V.AddComment=[ac,true];V.AddTag=[ac,true];V.AddTagByKeyword=[ac,true];V.CountCommentsOfUser=[ac,false];V.CountCommentsOfUserOnUrl=[ac,false];V.CountCommentsOnUrl=[ac,false];V.CountRatingsOnUrl=[ac,false];V.CountTagsOfUser=[ac,false];V.DeleteComment=[ac,true];V.DeleteRating=[ac,true];V.DeleteTag=[ac,true];V.DeleteTagByKeyword=[ac,true];V.DeleteTags=[ac,true];V.GetAllTagTerms=[ac,false];V.GetAllTagTermsForUrlFolder=[ac,false];V.GetAllTagUrls=[ac,false];V.GetAllTagUrlsByKeyword=[ac,false];V.GetCommentsOfUser=[ac,false];V.GetCommentsOfUserOnUrl=[ac,false];V.GetCommentsOnUrl=[ac,false];V.GetRatingAverageOnUrl=[ac,false];V.GetRatingOfUserOnUrl=[ac,false];V.GetRatingOnUrl=[ac,false];V.GetRatingsOfUser=[ac,false];V.GetRatingsOnUrl=[ac,false];V.GetSocialDataForFullReplication=[ac,false];V.GetTags=[ac,true];V.GetTagsOfUser=[ac,true];V.GetTagTerms=[ac,true];V.GetTagTermsOfUser=[ac,true];V.GetTagTermsOnUrl=[ac,true];V.GetTagUrlsOfUser=[ac,true];V.GetTagUrlsOfUserByKeyword=[ac,true];V.GetTagUrls=[ac,true];V.GetTagUrlsByKeyword=[ac,true];V.SetRating=[ac,true];V.UpdateComment=[ac,true];V.AddTerms=[ak,true];V.GetChildTermsInTerm=[ak,false];V.GetChildTermsInTermSet=[ak,false];V.GetKeywordTermsByGuids=[ak,false];V.GetTermsByLabel=[ak,false];V.GetTermSets=[ak,false];V.AddGroup=[X,true];V.AddGroupToRole=[X,true];V.AddRole=[X,true];V.AddRoleDef=[X,true];V.AddUserCollectionToGroup=[X,true];V.AddUserCollectionToRole=[X,true];V.AddUserToGroup=[X,true];V.AddUserToRole=[X,true];V.GetAllUserCollectionFromWeb=[X,false];V.GetGroupCollection=[X,false];V.GetGroupCollectionFromRole=[X,false];V.GetGroupCollectionFromSite=[X,false];V.GetGroupCollectionFromUser=[X,false];V.GetGroupCollectionFromWeb=[X,false];V.GetGroupInfo=[X,false];V.GetRoleCollection=[X,false];V.GetRoleCollectionFromGroup=[X,false];V.GetRoleCollectionFromUser=[X,false];V.GetRoleCollectionFromWeb=[X,false];V.GetRoleInfo=[X,false];V.GetRolesAndPermissionsForCurrentUser=[X,false];V.GetRolesAndPermissionsForSite=[X,false];V.GetUserCollection=[X,false];V.GetUserCollectionFromGroup=[X,false];V.GetUserCollectionFromRole=[X,false];V.GetUserCollectionFromSite=[X,false];V.GetUserCollectionFromWeb=[X,false];V.GetUserInfo=[X,false];V.GetUserLoginFromEmail=[X,false];V.RemoveGroup=[X,true];V.RemoveGroupFromRole=[X,true];V.RemoveRole=[X,true];V.RemoveUserCollectionFromGroup=[X,true];V.RemoveUserCollectionFromRole=[X,true];V.RemoveUserCollectionFromSite=[X,true];V.RemoveUserFromGroup=[X,true];V.RemoveUserFromRole=[X,true];V.RemoveUserFromSite=[X,true];V.RemoveUserFromWeb=[X,true];V.UpdateGroupInfo=[X,true];V.UpdateRoleDefInfo=[X,true];V.UpdateRoleInfo=[X,true];V.UpdateUserInfo=[X,true];V.AddColleague=[U,true];V.AddLink=[U,true];V.AddMembership=[U,true];V.AddPinnedLink=[U,true];V.CreateMemberGroup=[U,true];V.CreateUserProfileByAccountName=[U,true];V.GetCommonColleagues=[U,false];V.GetCommonManager=[U,false];V.GetCommonMemberships=[U,false];V.GetInCommon=[U,false];V.GetPropertyChoiceList=[U,false];V.GetUserColleagues=[U,false];V.GetUserLinks=[U,false];V.GetUserMemberships=[U,false];V.GetUserPinnedLinks=[U,false];V.GetUserProfileByGuid=[U,false];V.GetUserProfileByIndex=[U,false];V.GetUserProfileByName=[U,false];V.GetUserProfileCount=[U,false];V.GetUserProfileSchema=[U,false];V.ModifyUserPropertyByAccountName=[U,true];V.RemoveAllColleagues=[U,true];V.RemoveAllLinks=[U,true];V.RemoveAllMemberships=[U,true];V.RemoveAllPinnedLinks=[U,true];V.RemoveColleague=[U,true];V.RemoveLink=[U,true];V.RemoveMembership=[U,true];V.RemovePinnedLink=[U,true];V.UpdateColleaguePrivacy=[U,true];V.UpdateLink=[U,true];V.UpdateMembershipPrivacy=[U,true];V.UpdatePinnedLink=[U,true];V.DeleteAllVersions=[an,true];V.DeleteVersion=[an,true];V.GetVersions=[an,false];V.RestoreVersion=[an,true];V.AddView=[n,true];V.DeleteView=[n,true];V.GetView=[n,false];V.GetViewHtml=[n,false];V.GetViewCollection=[n,false];V.UpdateView=[n,true];V.UpdateViewHtml=[n,true];V.AddWebPart=[P,true];V.GetWebPart2=[P,false];V.GetWebPartPage=[P,false];V.GetWebPartProperties=[P,false];V.GetWebPartProperties2=[P,false];V.CreateContentType=[v,true];V.GetColumns=[v,false];V.GetContentType=[v,false];V.GetContentTypes=[v,false];V.GetCustomizedPageStatus=[v,false];V.GetListTemplates=[v,false];V.GetObjectIdFromUrl=[v,false];V.GetWeb=[v,false];V.GetWebCollection=[v,false];V.GetAllSubWebCollection=[v,false];V.UpdateColumns=[v,true];V.UpdateContentType=[v,true];V.WebUrlFromPageUrl=[v,false];V.AlterToDo=[d,true];V.GetTemplatesForItem=[d,false];V.GetToDosForItem=[d,false];V.GetWorkflowDataForItem=[d,false];V.GetWorkflowTaskData=[d,false];V.StartWorkflow=[d,true];var O={};O.header="<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>";O.footer="</soap:Body></soap:Envelope>";O.payload="";var Y;Q.fn.SPServices=function(i){var t=Q.extend({},Q.fn.SPServices.defaults,i);O.opheader="<"+t.operation+" ";switch(V[t.operation][0]){case q:O.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/' >";Y="http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/";break;case W:O.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/meetings/' >";Y="http://schemas.microsoft.com/sharepoint/soap/meetings/";break;case b:O.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/' >";Y="http://schemas.microsoft.com/sharepoint/soap/directory/";break;case z:O.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >";Y="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/";break;case J:O.opheader+="xmlns='urn:Microsoft.Search' >";Y="urn:Microsoft.Search/";break;case ac:O.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/SocialDataService' >";Y="http://microsoft.com/webservices/SharePointPortalServer/SocialDataService/";break;case ak:O.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/taxonomy/soap/' >";Y="http://schemas.microsoft.com/sharepoint/taxonomy/soap/";break;case X:O.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/' >";Y="http://schemas.microsoft.com/sharepoint/soap/directory/";break;case U:O.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >";Y="http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/";break;case P:O.opheader+="xmlns='http://microsoft.com/sharepoint/webpartpages' >";Y="http://microsoft.com/sharepoint/webpartpages/";break;case d:O.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/workflow/' >";Y="http://schemas.microsoft.com/sharepoint/soap/workflow/";break;default:O.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/'>";Y="http://schemas.microsoft.com/sharepoint/soap/";break}Y+=t.operation;O.opfooter="</"+t.operation+">";var ao="_vti_bin/"+V[t.operation][0]+".asmx";if(t.webURL.charAt(t.webURL.length-1)===k){ao=t.webURL+ao}else{if(t.webURL.length>0){ao=t.webURL+k+ao}else{ao=Q().SPServices.SPGetCurrentSite()+k+ao}}O.payload="";switch(t.operation){case"GetAlerts":break;case"DeleteAlerts":O.payload+="<IDs>";for(aj=0;aj<t.IDs.length;aj++){O.payload+=H("string",t.IDs[aj])}O.payload+="</IDs>";break;case"Mode":break;case"Login":j(t,["username","password"]);break;case"CopyIntoItems":j(t,["SourceUrl"]);O.payload+="<DestinationUrls>";for(aj=0;aj<t.DestinationUrls.length;aj++){O.payload+=H("string",t.DestinationUrls[aj])}O.payload+="</DestinationUrls>";j(t,["Fields","Stream","Results"]);break;case"CopyIntoItemsLocal":j(t,["SourceUrl"]);O.payload+="<DestinationUrls>";for(aj=0;aj<t.DestinationUrls.length;aj++){O.payload+=H("string",t.DestinationUrls[aj])}O.payload+="</DestinationUrls>";break;case"GetItem":j(t,["Url","Fields","Stream"]);break;case"GetForm":j(t,["listName","formUrl"]);break;case"GetFormCollection":j(t,["listName"]);break;case"AddAttachment":j(t,["listName","listItemID","fileName","attachment"]);break;case"AddList":j(t,["listName","description","templateID"]);break;case"ApplyContentTypeToList":j(t,["webUrl","contentTypeId","listName"]);break;case"CheckInFile":j(t,["pageUrl","comment","CheckinType"]);break;case"CheckOutFile":j(t,["pageUrl","checkoutToLocal","lastmodified"]);break;case"CreateContentType":j(t,["listName","displayName","parentType","fields","contentTypeProperties","addToView"]);break;case"DeleteAttachment":j(t,["listName","listItemID","url"]);break;case"DeleteContentType":j(t,["listName","contentTypeId"]);break;case"DeleteList":j(t,["listName"]);break;case"GetAttachmentCollection":j(t,["listName",["listItemID","ID"]]);break;case"GetList":j(t,["listName"]);break;case"GetListAndView":j(t,["listName","viewName"]);break;case"GetListCollection":break;case"GetListContentType":j(t,["listName","contentTypeId"]);break;case"GetListContentTypes":j(t,["listName"]);break;case"GetListItems":j(t,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"]]);break;case"GetListItemChanges":j(t,["listName","viewFields","since","contains"]);break;case"GetVersionCollection":j(t,["strlistID","strlistItemID","strFieldName"]);break;case"UndoCheckOut":j(t,["pageUrl"]);break;case"UpdateContentType":j(t,["listName","contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields","addToView"]);break;case"UpdateList":j(t,["listName","listProperties","newFields","updateFields","deleteFields","listVersion"]);break;case"UpdateListItems":j(t,["listName"]);if(t.updates!==undefined&&t.updates.length>0){j(t,["updates"])}else{O.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='"+t.batchCmd+"'>";for(aj=0;aj<t.valuepairs.length;aj++){O.payload+="<Field Name='"+t.valuepairs[aj][0]+"'>"+B(t.valuepairs[aj][1])+"</Field>"}if(t.batchCmd!=="New"){O.payload+="<Field Name='ID'>"+t.ID+"</Field>"}O.payload+="</Method></Batch></updates>"}break;case"AddMeeting":j(t,["organizerEmail","uid","sequence","utcDateStamp","title","location","utcDateStart","utcDateEnd","nonGregorian"]);break;case"CreateWorkspace":j(t,["title","templateName","lcid","timeZoneInformation"]);break;case"RemoveMeeting":j(t,["recurrenceId","uid","sequence","utcDateStamp","cancelMeeting"]);break;case"SetWorkspaceTitle":j(t,["title"]);break;case"SearchPrincipals":j(t,["searchText","maxResults","principalType"]);break;case"AddPermission":j(t,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"AddPermissionCollection":j(t,["objectName","objectType","permissionsInfoXml"]);break;case"GetPermissionCollection":j(t,["objectName","objectType"]);break;case"RemovePermission":j(t,["objectName","objectType","permissionIdentifier","permissionType"]);break;case"RemovePermissionCollection":j(t,["objectName","objectType","memberIdsXml"]);break;case"UpdatePermission":j(t,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"GetLinks":break;case"GetPortalSearchInfo":O.opheader="<"+t.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";Y="http://microsoft.com/webservices/OfficeServer/QueryService/"+t.operation;break;case"GetQuerySuggestions":O.opheader="<"+t.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";Y="http://microsoft.com/webservices/OfficeServer/QueryService/"+t.operation;O.payload+=H("queryXml",a(t.queryXml));break;case"GetSearchMetadata":O.opheader="<"+t.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";Y="http://microsoft.com/webservices/OfficeServer/QueryService/"+t.operation;break;case"Query":O.payload+=H("queryXml",a(t.queryXml));break;case"QueryEx":O.opheader="<"+t.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";Y="http://microsoft.com/webservices/OfficeServer/QueryService/"+t.operation;O.payload+=H("queryXml",a(t.queryXml));break;case"Registration":O.payload+=H("registrationXml",a(t.registrationXml));break;case"Status":break;case"EnumerateFolder":j(t,["strFolderUrl"]);break;case"GetAttachments":j(t,["strListName","strItemId"]);break;case"SiteDataGetList":j(t,["strListName"]);O=ae(O,t.operation);break;case"SiteDataGetListCollection":O=ae(O,t.operation);break;case"SiteDataGetSite":O=ae(O,t.operation);break;case"SiteDataGetSiteUrl":j(t,["Url"]);O=ae(O,t.operation);break;case"SiteDataGetWeb":O=ae(O,t.operation);break;case"AddComment":j(t,["url","comment","isHighPriority","title"]);break;case"AddTag":j(t,["url","termID","title","isPrivate"]);break;case"AddTagByKeyword":j(t,["url","keyword","title","isPrivate"]);break;case"CountCommentsOfUser":j(t,["userAccountName"]);break;case"CountCommentsOfUserOnUrl":j(t,["userAccountName","url"]);break;case"CountCommentsOnUrl":j(t,["url"]);break;case"CountRatingsOnUrl":j(t,["url"]);break;case"CountTagsOfUser":j(t,["userAccountName"]);break;case"DeleteComment":j(t,["url","lastModifiedTime"]);break;case"DeleteRating":j(t,["url"]);break;case"DeleteTag":j(t,["url","termID"]);break;case"DeleteTagByKeyword":j(t,["url","keyword"]);break;case"DeleteTags":j(t,["url"]);break;case"GetAllTagTerms":j(t,["maximumItemsToReturn"]);break;case"GetAllTagTermsForUrlFolder":j(t,["urlFolder","maximumItemsToReturn"]);break;case"GetAllTagUrls":j(t,["termID"]);break;case"GetAllTagUrlsByKeyword":j(t,["keyword"]);break;case"GetCommentsOfUser":j(t,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetCommentsOfUserOnUrl":j(t,["userAccountName","url"]);break;case"GetCommentsOnUrl":j(t,["url","maximumItemsToReturn","startIndex"]);if(t.excludeItemsTime!==undefined&&t.excludeItemsTime.length>0){O.payload+=H("excludeItemsTime",t.excludeItemsTime)}break;case"GetRatingAverageOnUrl":j(t,["url"]);break;case"GetRatingOfUserOnUrl":j(t,["userAccountName","url"]);break;case"GetRatingOnUrl":j(t,["url"]);break;case"GetRatingsOfUser":j(t,["userAccountName"]);break;case"GetRatingsOnUrl":j(t,["url"]);break;case"GetSocialDataForFullReplication":j(t,["userAccountName"]);break;case"GetTags":j(t,["url"]);break;case"GetTagsOfUser":j(t,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetTagTerms":j(t,["maximumItemsToReturn"]);break;case"GetTagTermsOfUser":j(t,["userAccountName","maximumItemsToReturn"]);break;case"GetTagTermsOnUrl":j(t,["url","maximumItemsToReturn"]);break;case"GetTagUrls":j(t,["termID"]);break;case"GetTagUrlsByKeyword":j(t,["keyword"]);break;case"GetTagUrlsOfUser":j(t,["termID","userAccountName"]);break;case"GetTagUrlsOfUserByKeyword":j(t,["keyword","userAccountName"]);break;case"SetRating":j(t,["url","rating","title","analysisDataEntry"]);break;case"UpdateComment":j(t,["url","lastModifiedTime","comment","isHighPriority"]);break;case"AddTerms":j(t,["sharedServiceId","termSetId","lcid","newTerms"]);break;case"GetChildTermsInTerm":j(t,["sspId","lcid","termId","termSetId"]);break;case"GetChildTermsInTermSet":j(t,["sspId","lcid","termSetId"]);break;case"GetKeywordTermsByGuids":j(t,["termIds","lcid"]);break;case"GetTermsByLabel":j(t,["label","lcid","matchOption","resultCollectionSize","termIds","addIfNotFound"]);break;case"GetTermSets":j(t,["sharedServiceId","termSetId","lcid","clientTimeStamps","clientVersions"]);break;case"AddGroup":j(t,["groupName","ownerIdentifier","ownerType","defaultUserLoginName","description"]);break;case"AddGroupToRole":j(t,["groupName","roleName"]);break;case"AddRole":j(t,["roleName","description","permissionMask"]);break;case"AddRoleDef":j(t,["roleName","description","permissionMask"]);break;case"AddUserCollectionToGroup":j(t,["groupName","usersInfoXml"]);break;case"AddUserCollectionToRole":j(t,["roleName","usersInfoXml"]);break;case"AddUserToGroup":j(t,["groupName","userName","userLoginName","userEmail","userNotes"]);break;case"AddUserToRole":j(t,["roleName","userName","userLoginName","userEmail","userNotes"]);break;case"GetAllUserCollectionFromWeb":break;case"GetGroupCollection":j(t,["groupNamesXml"]);break;case"GetGroupCollectionFromRole":j(t,["roleName"]);break;case"GetGroupCollectionFromSite":break;case"GetGroupCollectionFromUser":j(t,["userLoginName"]);break;case"GetGroupCollectionFromWeb":break;case"GetGroupInfo":j(t,["groupName"]);break;case"GetRoleCollection":j(t,["roleNamesXml"]);break;case"GetRoleCollectionFromGroup":j(t,["groupName"]);break;case"GetRoleCollectionFromUser":j(t,["userLoginName"]);break;case"GetRoleCollectionFromWeb":break;case"GetRoleInfo":j(t,["roleName"]);break;case"GetRolesAndPermissionsForCurrentUser":break;case"GetRolesAndPermissionsForSite":break;case"GetUserCollection":j(t,["userLoginNamesXml"]);break;case"GetUserCollectionFromGroup":j(t,["groupName"]);break;case"GetUserCollectionFromRole":j(t,["roleName"]);break;case"GetUserCollectionFromSite":break;case"GetUserCollectionFromWeb":break;case"GetUserInfo":j(t,["userLoginName"]);break;case"GetUserLoginFromEmail":j(t,["emailXml"]);break;case"RemoveGroup":j(t,["groupName"]);break;case"RemoveGroupFromRole":j(t,["roleName","groupName"]);break;case"RemoveRole":j(t,["roleName"]);break;case"RemoveUserCollectionFromGroup":j(t,["groupName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromRole":j(t,["roleName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromSite":j(t,["userLoginNamesXml"]);break;case"RemoveUserFromGroup":j(t,["groupName","userLoginName"]);break;case"RemoveUserFromRole":j(t,["roleName","userLoginName"]);break;case"RemoveUserFromSite":j(t,["userLoginName"]);break;case"RemoveUserFromWeb":j(t,["userLoginName"]);break;case"UpdateGroupInfo":j(t,["oldGroupName","groupName","ownerIdentifier","ownerType","description"]);break;case"UpdateRoleDefInfo":j(t,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateRoleInfo":j(t,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateUserInfo":j(t,["userLoginName","userName","userEmail","userNotes"]);break;case"AddColleague":j(t,["accountName","colleagueAccountName","group","privacy","isInWorkGroup"]);break;case"AddLink":j(t,["accountName","name","url","group","privacy"]);break;case"AddMembership":j(t,["accountName","membershipInfo","group","privacy"]);break;case"AddPinnedLink":j(t,["accountName","name","url"]);break;case"CreateMemberGroup":j(t,["membershipInfo"]);break;case"CreateUserProfileByAccountName":j(t,["accountName"]);break;case"GetCommonColleagues":j(t,["accountName"]);break;case"GetCommonManager":j(t,["accountName"]);break;case"GetCommonMemberships":j(t,["accountName"]);break;case"GetInCommon":j(t,["accountName"]);break;case"GetPropertyChoiceList":j(t,["propertyName"]);break;case"GetUserColleagues":j(t,["accountName"]);break;case"GetUserLinks":j(t,["accountName"]);break;case"GetUserMemberships":j(t,["accountName"]);break;case"GetUserPinnedLinks":j(t,["accountName"]);break;case"GetUserProfileByGuid":j(t,["guid"]);break;case"GetUserProfileByIndex":j(t,["index"]);break;case"GetUserProfileByName":if(t.accountName!==undefined&&t.accountName.length>0){j(t,[["AccountName","accountName"]])}else{j(t,["AccountName"])}break;case"GetUserProfileCount":break;case"GetUserProfileSchema":break;case"ModifyUserPropertyByAccountName":j(t,["accountName","newData"]);break;case"RemoveAllColleagues":j(t,["accountName"]);break;case"RemoveAllLinks":j(t,["accountName"]);break;case"RemoveAllMemberships":j(t,["accountName"]);break;case"RemoveAllPinnedLinks":j(t,["accountName"]);break;case"RemoveColleague":j(t,["accountName","colleagueAccountName"]);break;case"RemoveLink":j(t,["accountName","id"]);break;case"RemoveMembership":j(t,["accountName","sourceInternal","sourceReference"]);break;case"RemovePinnedLink":j(t,["accountName","id"]);break;case"UpdateColleaguePrivacy":j(t,["accountName","colleagueAccountName","newPrivacy"]);break;case"UpdateLink":j(t,["accountName","data"]);break;case"UpdateMembershipPrivacy":j(t,["accountName","sourceInternal","sourceReference","newPrivacy"]);break;case"UpdatePinnedLink ":j(t,["accountName","data"]);break;case"DeleteAllVersions":j(t,["fileName"]);break;case"DeleteVersion":j(t,["fileName","fileVersion"]);break;case"GetVersions":j(t,["fileName"]);break;case"RestoreVersion":j(t,["fileName","fileVersion"]);break;case"AddView":j(t,["listName","viewName","viewFields","query","rowLimit","rowLimit","type","makeViewDefault"]);break;case"DeleteView":j(t,["listName","viewName"]);break;case"GetView":j(t,["listName","viewName"]);break;case"GetViewCollection":j(t,["listName"]);break;case"GetViewHtml":j(t,["listName","viewName"]);break;case"UpdateView":j(t,["listName","viewName","viewProperties","query","viewFields","aggregations","formats","rowLimit"]);break;case"UpdateViewHtml":j(t,["listName","viewName","viewProperties","toolbar","viewHeader","viewBody","viewFooter","viewEmpty","rowLimitExceeded","query","viewFields","aggregations","formats","rowLimit"]);break;case"AddWebPart":j(t,["pageUrl","webPartXml","storage"]);break;case"GetWebPart2":j(t,["pageUrl","storageKey","storage","behavior"]);break;case"GetWebPartPage":j(t,["documentName","behavior"]);break;case"GetWebPartProperties":j(t,["pageUrl","storage"]);break;case"GetWebPartProperties2":j(t,["pageUrl","storage","behavior"]);break;case"CreateContentType":j(t,["displayName","parentType","newFields","contentTypeProperties"]);break;case"GetColumns":j(t,["webUrl"]);break;case"GetContentType":j(t,["contentTypeId"]);break;case"GetContentTypes":break;case"GetCustomizedPageStatus":j(t,["fileUrl"]);break;case"GetListTemplates":break;case"GetObjectIdFromUrl":j(t,["objectUrl"]);break;case"GetWeb":j(t,[["webUrl","webURL"]]);break;case"GetWebCollection":break;case"GetAllSubWebCollection":break;case"UpdateColumns":j(t,["newFields","updateFields","deleteFields"]);break;case"UpdateContentType":j(t,["contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields"]);break;case"WebUrlFromPageUrl":j(t,[["pageUrl","pageURL"]]);break;case"AlterToDo":j(t,["item","todoId","todoListId","taskData"]);break;case"GetTemplatesForItem":j(t,["item"]);break;case"GetToDosForItem":j(t,["item"]);break;case"GetWorkflowDataForItem":j(t,["item"]);break;case"GetWorkflowTaskData":j(t,["item","listId","taskId"]);break;case"StartWorkflow":j(t,["item","templateId","workflowParameters"]);break;default:break}var ap=O.header+O.opheader+O.payload+O.opfooter+O.footer;Q.ajax({url:ao,async:t.async,beforeSend:function(aq){if(V[t.operation][1]){aq.setRequestHeader("SOAPAction",Y)}},type:"POST",data:ap,dataType:"xml",contentType:"text/xml;charset='utf-8'",complete:t.completefunc})};Q.fn.SPServices.defaults={operation:"",webURL:"",makeViewDefault:false,CAMLViewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions></QueryOptions>",batchCmd:"Update",valuepairs:[],DestinationUrls:[],behavior:"Version3",storage:"Shared",objectType:"List",cancelMeeting:true,nonGregorian:false,fClaim:false,recurrenceId:0,sequence:0,maximumItemsToReturn:0,startIndex:0,isHighPriority:false,isPrivate:false,rating:1,maxResults:10,principalType:"User",async:true,completefunc:null};Q.fn.SPServices.SPGetCurrentSite=function(){if(f.length>0){return f}var i=O.header+"<WebUrlFromPageUrl xmlns='http://schemas.microsoft.com/sharepoint/soap/' ><pageUrl>"+((location.href.indexOf("?")>0)?location.href.substr(0,location.href.indexOf("?")):location.href)+"</pageUrl></WebUrlFromPageUrl>"+O.footer;Q.ajax({async:false,url:"/_vti_bin/Webs.asmx",type:"POST",data:i,dataType:"xml",contentType:'text/xml;charset="utf-8"',complete:function(ao,t){f=Q(ao.responseXML).find("WebUrlFromPageUrlResult").text()}});return f};Q.fn.SPServices.SPCascadeDropdowns=function(ao){var ar=Q.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListParentColumn:"",relationshipListChildColumn:"",relationshipListSortColumn:"",parentColumn:"",childColumn:"",listName:Q().SPServices.SPListNameFromUrl(),CAMLQuery:"",promptText:"",noneText:"(None)",simpleChild:false,selectSingleOption:false,matchOnId:false,completefunc:null,debug:false},ao);var aq=false;var au="SPServices.SPCascadeDropdowns";var ap=new ad(ar.parentColumn);if(ap.Obj.html()===null&&ar.debug){N(au,"parentColumn: "+ar.parentColumn,Z);return}var i=new ad(ar.childColumn);if(i.Obj.html()===null&&ar.debug){N(au,"childColumn: "+ar.childColumn,Z);return}if(ar.simpleChild===true&&i.Type==="C"){Q().SPServices.SPComplexToSimpleDropdown({columnName:ar.childColumn});i=new ad(ar.childColumn)}Q().SPServices({operation:"GetList",async:false,listName:ar.listName,completefunc:function(aw,av){Q(aw.responseXML).find("Fields").each(function(){Q(this).find("Field[DisplayName='"+ar.childColumn+"']").each(function(){childColumnRequired=(Q(this).attr("Required")==="TRUE")?true:false;childColumnStatic=Q(this).attr("StaticName");return false})})}});var at={opt:ar,childSelect:i,childColumnStatic:childColumnStatic,childColumnRequired:childColumnRequired};var t=ap.Obj.data("SPCascadeDropdownsChildColumns");if(t===undefined){ap.Obj.data("SPCascadeDropdownsChildColumns",[at])}else{t.push(at);ap.Obj.data("SPCascadeDropdownsChildColumns",t);aq=true}if(!aq){switch(ap.Type){case"S":ap.Obj.bind("change",function(){ah(ar.parentColumn,ap)});break;case"C":Q("input[id='"+ap.Obj.attr("optHid")+"']").bind("propertychange",function(){ah(ar.parentColumn,ap)});break;case"M":ap.Obj.bind("dblclick",function(){ah(ar.parentColumn,ap)});parentSelections=ap.Obj.closest("span").find("select[ID$='SelectResult'][Title^='"+ar.parentColumn+" ']");parentSelections.bind("dblclick",function(){ah(ar.parentColumn,ap)});ap.Obj.closest("span").find("button").each(function(){Q(this).bind("click",function(){ah(ar.parentColumn,ap)})});break;default:break}}ah(ar.parentColumn,ap)};function ah(ax,aq){var ay="";var ap;var at=null;var i;var au;var aw;var ar;var av;var ao;var t=aq.Obj.data("SPCascadeDropdownsChildColumns");Q(t).each(function(){var aC=this.opt;var aA=this.childSelect;var aF=this.childColumnStatic;var aB=this.childColumnRequired;ap=S(aq,aC.matchOnId);if(aq.Obj.data("SPCascadeDropdown_Selected_"+aF)===ap.join(";#")){return}aq.Obj.data("SPCascadeDropdown_Selected_"+aF,ap.join(";#"));at=S(aA,true);var aE=(aC.relationshipListSortColumn.length>0)?aC.relationshipListSortColumn:aC.relationshipListChildColumn;var az="<Query><OrderBy><FieldRef Name='"+aE+"'/></OrderBy><Where><And>";if(aC.CAMLQuery.length>0){az+="<And>"}if(ap.length===0){az+="<Eq><FieldRef Name='"+aC.relationshipListParentColumn+"'/><Value Type='Text'></Value></Eq>"}else{if(ap.length===1){az+="<Eq><FieldRef Name='"+aC.relationshipListParentColumn+(aC.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+B(ap[0])+"</Value></Eq>"}else{var aD=(ap.length>2)?true:false;for(aj=0;aj<(ap.length-1);aj++){az+="<Or>"}for(aj=0;aj<ap.length;aj++){az+="<Eq><FieldRef Name='"+aC.relationshipListParentColumn+aC.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>"+B(ap[0])+"</Value></Eq>";if(aj>0&&(aj<(ap.length-1))&&aD){az+="</Or>"}}az+="</Or>"}}if(aC.CAMLQuery.length>0){az+=aC.CAMLQuery+"</And>"}az+="<IsNotNull><FieldRef Name='"+aC.relationshipListChildColumn+"' /></IsNotNull>";az+="</And></Where></Query>";Q().SPServices({operation:"GetListItems",async:false,webURL:aC.relationshipWebURL,listName:aC.relationshipList,CAMLQuery:az,CAMLViewFields:"<ViewFields><FieldRef Name='"+aC.relationshipListParentColumn+"' /><FieldRef Name='"+aC.relationshipListChildColumn+"' /></ViewFields>",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns></QueryOptions>",completefunc:function(aH,aG){Q(aH.responseXML).find("errorstring").each(function(){var aJ="SPServices.SPCascadeDropdowns";var aI=Q(this).text();if(aC.debug&&aI==="One or more field types are not installed properly. Go to the list settings page to delete these fields."){N(aJ,"relationshipListParentColumn: "+aC.relationshipListParentColumn+" or relationshipListChildColumn: "+aC.relationshipListChildColumn,"Not found in relationshipList "+aC.relationshipList)}else{if(aC.debug&&aI==="Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."){N(aJ,"relationshipList: "+aC.relationshipList,"List not found")}}return});switch(aA.Type){case"S":Q(aA.Obj).find("option").remove();if(!aB&&(aC.promptText.length>0)){aA.Obj.append("<option value='0'>"+aC.promptText.replace(/\{0\}/g,aC.childColumn)+"</option>")}else{if(!aB){aA.Obj.append("<option value='0'>"+aC.noneText+"</option>")}}break;case"C":ay=aB?"":aC.noneText+"|0";aA.Obj.attr("value","");break;case"M":Q(aA.Obj).find("option").remove();aw="";break;default:break}ar=parseFloat(Q(aH.responseXML).SPFilterNode("rs:data").attr("ItemCount"));Q(aH.responseXML).SPFilterNode("z:row").each(function(){var aK,aJ;var aI=Q(this).attr("ows_"+aC.relationshipListChildColumn);if(aI!==undefined&&aI.indexOf(";#")>0){var aM=aI.split(";#");aK=aM[0];aJ=aM[1]}else{aK=Q(this).attr("ows_ID");aJ=aI}if(isNaN(aK)){aK=Q(this).attr("ows_ID")}av=aK;ao=aJ;switch(aA.Type){case"S":var aL=(Q(this).attr("ows_ID")===at[0])?" selected='selected'":"";aA.Obj.append("<option"+aL+" value='"+aK+"'>"+aJ+"</option>");break;case"C":if(aK===at[0]){aA.Obj.attr("value",aJ)}ay=ay+((ay.length>0)?"|":"")+aJ+"|"+aK;break;case"M":aA.Obj.append("<option value='"+aK+"'>"+aJ+"</option>");aw+=aK+"|t"+aJ+"|t |t |t";break;default:break}});switch(aA.Type){case"S":aA.Obj.trigger("change");if(ar===1&&aC.selectSingleOption===true){Q(aA.Obj).find("option[value!='0']:first").attr("selected","selected")}break;case"C":aA.Obj.attr("choices",ay);if(ar===1&&aC.selectSingleOption===true){Q(aA.Obj).attr("value",ao);Q("input[id='"+aA.Obj.attr("optHid")+"']").val(av)}if(aA.Obj.val()===""){Q("input[id='"+aA.Obj.attr("optHid")+"']").val("")}break;case"M":au=aA.Obj.closest("span").find("input[name$='MultiLookupPicker$data']");i=window[aA.Obj.closest("tr").find("button[id$='AddButton']").attr("id").replace(/AddButton/,"MultiLookupPicker_m")];currentSelection=aA.Obj.closest("span").find("select[ID$='SelectResult'][Title^='"+aC.childColumn+" ']");i.data="";au.attr("value",aw);Q(currentSelection).find("option").each(function(){var aJ=Q(this);var aI=Q(this).html();Q(this).attr("selected","selected");Q(aA.Obj).find("option:contains('"+aI+"')").each(function(){if(Q(this).html()===aI){aJ.removeAttr("selected")}})});GipRemoveSelectedItems(i);Q(aA.Obj).find("option").each(function(){var aI=Q(this);Q(currentSelection).find("option").each(function(){if(Q(this).html()===aI.html()){aI.remove()}})});GipAddSelectedItems(i);i.data=GipGetGroupData(aw);aA.Obj.trigger("dblclick");break;default:break}}});if(aC.completefunc!==null){aC.completefunc()}})}Q.fn.SPServices.SPComplexToSimpleDropdown=function(aw){var i=Q.extend({},{columnName:"",completefunc:null,debug:false},aw);var ao=new ad(i.columnName);if(ao.Obj.html()===null&&i.debug){N("SPServices.SPComplexToSimpleDropdown","columnName: "+i.columnName,Z);return}if(ao.Type!=="C"){return}var au=Q(ao.Obj).attr("choices").split("|");var ap=Q(ao.Obj).attr("optHid");var av=Q("input[id='"+ap+"']");var t=Q("input[id='"+ap+"']").val();var aq=m("SPComplexToSimpleDropdown",i.columnName);var at="<select id='"+aq+"' title='"+i.columnName+"'>";for(aj=0;aj<au.length;aj=aj+2){var ar=(au[aj+1]===t)?" selected='selected' ":" ";at+="<option"+ar+"value='"+au[aj+1]+"'>"+au[aj]+"</option>"}at+="</select>";Q(ao.Obj).closest("td").prepend(at);Q(ao.Obj).closest("span").find("img").remove();Q(ao.Obj).closest("span").find("input").hide();Q("#"+aq).change(function(){var ax=Q(this).val();av.val(ax);Q(ao.Obj).val(Q(this).find("option[value='"+(ax!=="0"?ax:"")+"']").html())});Q("#"+aq).trigger("change");if(i.completefunc!==null){i.completefunc()}};Q.fn.SPServices.SPDisplayRelatedInfo=function(t){var ap=Q.extend({},{columnName:"",relatedWebURL:"",relatedList:"",relatedListColumn:"",relatedColumns:[],displayFormat:"table",headerCSSClass:"ms-vh2",rowCSSClass:"ms-vb",CAMLQuery:"",numChars:0,matchType:"Eq",matchOnId:false,completefunc:null,debug:false},t);var i;var ao=[];var at;var ar="SPServices.SPDisplayRelatedInfo";var aq=new ad(ap.columnName);if(aq.Obj.html()===null&&ap.debug){N(ar,"columnName: "+ap.columnName,Z);return}i=m("SPDisplayRelatedInfo",ap.columnName);Q().SPServices({operation:"GetList",async:false,webURL:ap.relatedWebURL,listName:ap.relatedList,completefunc:function(av,au){Q(av.responseXML).find("faultcode").each(function(){if(ap.debug){N(ar,"relatedList: "+ap.relatedList,"List not found");return}});at=Q(av.responseXML).find("List");for(aj=0;aj<ap.relatedColumns.length;aj++){ao[aj]=Q(av.responseXML).find("Fields > Field[Name='"+ap.relatedColumns[aj]+"']")}}});switch(aq.Type){case"S":aq.Obj.bind("change",function(){L(ap,i,at,ao)});break;case"C":Q("input[id='"+aq.Obj.attr("optHid")+"']").bind("propertychange",function(){L(ap,i,at,ao)});break;case"M":if(ap.debug){N(ar,"columnName: "+ap.columnName,"Multi-select columns not supported by this function")}break;default:break}L(ap,i,at,ao)};function L(t,ar,au,ao){var av=null;var aq="SPServices.SPDisplayRelatedInfo";var ap=new ad(t.columnName);av=S(ap,t.matchOnId);if(ap.Type==="C"&&t.numChars>0&&av[0].length<t.numChars){return}if(ap.Obj.attr("showRelatedSelected")===av[0]){return}ap.Obj.attr("showRelatedSelected",av[0]);Q("#"+ar).remove();ap.Obj.parent().append("<div id="+ar+"></div>");var i="<Query><Where>";if(t.CAMLQuery.length>0){i+="<And>"}i+="<Eq><FieldRef Name='"+t.relatedListColumn+(t.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+B(av[0])+"</Value></Eq>";if(t.CAMLQuery.length>0){i+=t.CAMLQuery+"</And>"}i+="</Where></Query>";var at=" ";for(aj=0;aj<t.relatedColumns.length;aj++){at+="<FieldRef Name='"+t.relatedColumns[aj]+"' />"}Q().SPServices({operation:"GetListItems",async:false,webURL:t.relatedWebURL,listName:t.relatedList,CAMLQuery:i,CAMLViewFields:"<ViewFields>"+at+"</ViewFields>",CAMLRowLimit:0,completefunc:function(ay,ax){Q(ay.responseXML).find("errorstring").each(function(){var az=Q(this).text();if(t.debug&&az==="One or more field types are not installed properly. Go to the list settings page to delete these fields."){N(aq,"relatedListColumn: "+t.relatedListColumn,"Column not found in relatedList "+t.relatedList)}else{if(t.debug&&az==="Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."){N(aq,"relatedList: "+t.relatedList,"List not found")}}return});var aw;switch(t.displayFormat){case"table":aw="<table>";aw+="<tr>";for(aj=0;aj<t.relatedColumns.length;aj++){if(typeof ao[aj]==="undefined"&&t.debug){N(aq,"columnName: "+t.relatedColumns[aj],"Column not found in relatedList");return}aw+="<th class='"+t.headerCSSClass+"'>"+ao[aj].attr("DisplayName")+"</th>"}aw+="</tr>";Q(ay.responseXML).SPFilterNode("z:row").each(function(){aw+="<tr>";for(aj=0;aj<t.relatedColumns.length;aj++){aw+="<td class='"+t.rowCSSClass+"'>"+D(au,ao[aj],Q(this).attr("ows_"+t.relatedColumns[aj]),t)+"</td>"}aw+="</tr>"});aw+="</table>";break;case"list":aw="<table>";Q(ay.responseXML).SPFilterNode("z:row").each(function(){for(aj=0;aj<t.relatedColumns.length;aj++){if(typeof ao[aj]==="undefined"&&t.debug){N(aq,"columnName: "+t.relatedColumns[aj],"Column not found in relatedList");return}aw+="<tr>";aw+="<th class='"+t.headerCSSClass+"'>"+ao[aj].attr("DisplayName")+"</th>";aw+="<td class='"+t.rowCSSClass+"'>"+D(au,ao[aj],Q(this).attr("ows_"+t.relatedColumns[aj]),t)+"</td>";aw+="</tr>"}});aw+="</table>";break;default:break}Q("#"+ar).html(aw)}});if(t.completefunc!==null){t.completefunc()}}Q.fn.SPServices.SPFilterDropdown=function(ay){var ao=Q.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListColumn:"",relationshipListSortColumn:"",columnName:"",listName:Q().SPServices.SPListNameFromUrl(),promptText:"",noneText:"(None)",CAMLQuery:"",CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns><ViewAttributes Scope='RecursiveAll'/></QueryOptions>",completefunc:null,debug:false},ay);var ax="";var aw=null;var t;var aq;var av;var au;var at="SPServices.SPFilterDropdown";var ar=new ad(ao.columnName);if(ar.Obj.html()===null&&ao.debug){N(at,"columnName: "+ao.columnName,Z);return}aw=S(ar,true);var ap=(ao.relationshipListSortColumn.length>0)?ao.relationshipListSortColumn:ao.relationshipListColumn;var i="<Query><OrderBy><FieldRef Name='"+ap+"'/></OrderBy><Where>";if(ao.CAMLQuery.length>0){i+=ao.CAMLQuery}i+="</Where></Query>";Q().SPServices({operation:"GetList",async:false,listName:ao.listName,completefunc:function(aA,az){Q(aA.responseXML).find("Fields").each(function(){Q(this).find("Field[DisplayName='"+ao.columnName+"']").each(function(){au=(Q(this).attr("Required")==="TRUE")?true:false;return false})})}});Q().SPServices({operation:"GetListItems",async:false,webURL:ao.relationshipWebURL,listName:ao.relationshipList,CAMLQuery:i,CAMLViewFields:"<ViewFields><FieldRef Name='"+ao.relationshipListColumn+"' /></ViewFields>",CAMLRowLimit:0,CAMLQueryOptions:ao.CAMLQueryOptions,completefunc:function(aA,az){Q(aA.responseXML).find("errorstring").each(function(){var aB=Q(this).text();if(ao.debug&&aB==="One or more field types are not installed properly. Go to the list settings page to delete these fields."){N(at,"relationshipListColumn: "+ao.relationshipListColumn,"Not found in relationshipList "+ao.relationshipList)}else{if(ao.debug&&aB==="Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."){N(at,"relationshipList: "+ao.relationshipList,"List not found")}}return});switch(ar.Type){case"S":Q(ar.Obj).find("option").remove();if(!au&&(ao.promptText.length>0)){ar.Obj.append("<option value='0'>"+ao.promptText.replace(/\{0\}/g,ao.columnName)+"</option>")}else{if(!au){ar.Obj.append("<option value='0'>"+ao.noneText+"</option>")}}break;case"C":ax=au?"":ao.noneText+"|0";ar.Obj.attr("value","");break;case"M":Q(ar.Obj).find("option").remove();av="";break;default:break}Q(aA.responseXML).SPFilterNode("z:row").each(function(){var aD,aC;var aB=Q(this).attr("ows_"+ao.relationshipListColumn);if(aB!==undefined&&aB.indexOf(";#")>0){var aF=aB.split(";#");aD=aF[0];aC=aF[1]}else{aD=Q(this).attr("ows_ID");aC=aB}if(isNaN(aD)){aD=Q(this).attr("ows_ID")}switch(ar.Type){case"S":var aE=(Q(this).attr("ows_ID")===aw[0])?" selected='selected'":"";ar.Obj.append("<option"+aE+" value='"+aD+"'>"+aC+"</option>");break;case"C":if(aD===aw[0]){ar.Obj.attr("value",aC)}ax=ax+((ax.length>0)?"|":"")+aC+"|"+aD;break;case"M":ar.Obj.append("<option value='"+aD+"'>"+aC+"</option>");av+=aD+"|t"+aC+"|t |t |t";break;default:break}});switch(ar.Type){case"S":ar.Obj.trigger("change");break;case"C":ar.Obj.attr("choices",ax);ar.Obj.trigger("propertychange");break;case"M":aq=ar.Obj.closest("span").find("input[name$='MultiLookupPicker$data']");t=window[ar.Obj.closest("tr").find("button[id$='AddButton']").attr("id").replace(/AddButton/,"MultiLookupPicker_m")];currentSelection=ar.Obj.closest("span").find("select[ID$='SelectResult'][Title^='"+ao.columnName+" ']");t.data="";aq.attr("value",av);Q(currentSelection).find("option").each(function(){var aB=Q(this);Q(this).attr("selected","selected");Q(ar.Obj).find("option").each(function(){if(Q(this).html()===aB.html()){aB.removeAttr("selected")}})});GipRemoveSelectedItems(t);Q(ar.Obj).find("option").each(function(){var aB=Q(this);Q(currentSelection).find("option").each(function(){if(Q(this).html()===aB.html()){aB.remove()}})});GipAddSelectedItems(t);t.data=GipGetGroupData(av);ar.Obj.trigger("dblclick");break;default:break}}});if(ao.completefunc!==null){ao.completefunc()}};Q.fn.SPServices.SPDebugXMLHttpResult=function(ao){var aq=Q.extend({},{node:null,indent:0},ao);var ap;var at=3;var ar=4;var t="";t+="<table class='ms-vb' style='margin-left:"+aq.indent*3+"px;' width='100%'>";if(aq.node.nodeName==="DisplayPattern"){t+="<tr><td width='100px' style='font-weight:bold;'>"+aq.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+aq.node.xml+"</textarea></td></tr>"}else{if(!aq.node.hasChildNodes()){t+="<tr><td width='100px' style='font-weight:bold;'>"+aq.node.nodeName+"</td><td>"+((aq.node.nodeValue!==null)?A(aq.node.nodeValue):"&nbsp;")+"</td></tr>";if(aq.node.attributes){t+="<tr><td colspan='99'>"+af(aq.node,aq)+"</td></tr>"}}else{if(aq.node.hasChildNodes()&&aq.node.firstChild.nodeType===ar){t+="<tr><td width='100px' style='font-weight:bold;'>"+aq.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+aq.node.parentNode.text+"</textarea></td></tr>"}else{if(aq.node.hasChildNodes()&&aq.node.firstChild.nodeType===at){t+="<tr><td width='100px' style='font-weight:bold;'>"+aq.node.nodeName+"</td><td>"+A(aq.node.firstChild.nodeValue)+"</td></tr>"}else{t+="<tr><td width='100px' style='font-weight:bold;' colspan='99'>"+aq.node.nodeName+"</td></tr>";if(aq.node.attributes){t+="<tr><td colspan='99'>"+af(aq.node,aq)+"</td></tr>"}t+="<tr><td>";for(ap=0;ap<aq.node.childNodes.length;ap++){t+=Q().SPServices.SPDebugXMLHttpResult({node:aq.node.childNodes.item(ap),indent:aq.indent+1})}t+="</td></tr>"}}}}t+="</table>";return t};Q.fn.SPServices.SPGetCurrentUser=function(ao){var ap=Q.extend({},{fieldName:"Name",debug:false},ao);if(ap.fieldName==="ID"){return _spUserId}var t="";var i=RegExp('FieldInternalName="'+ap.fieldName+'"',"gi");Q.ajax({async:false,url:Q().SPServices.SPGetCurrentSite()+"/_layouts/userdisp.aspx?Force=True&"+new Date().getTime(),complete:function(ar,aq){Q(ar.responseText).find("table.ms-formtable td[id^='SPField']").each(function(){if(i.test(Q(this).html())){switch(Q(this).attr("id")){case"SPFieldText":t=Q(this).text();break;case"SPFieldNote":t=Q(this).find("div").html();break;case"SPFieldURL":t=Q(this).find("img").attr("src");break;default:t=Q(this).text();break}return false}})}});return(t!==undefined)?t.replace(/(^[\s\xA0]+|[\s\xA0]+$)/g,""):null};Q.fn.SPServices.SPLookupAddNew=function(ap){var aq=Q.extend({},{lookupColumn:"",promptText:"Add new {0}",newWindow:false,ContentTypeID:"",completefunc:null,debug:false},ap);var au="SPServices.SPLookupAddNew";var ao=new ad(aq.lookupColumn);if(ao.Obj.html()===null&&aq.debug){N(au,"lookupColumn: "+aq.lookupColumn,Z);return}var at="";var t="";var ar="";Q().SPServices({operation:"GetList",async:false,listName:Q().SPServices.SPListNameFromUrl(),completefunc:function(aw,av){Q(aw.responseXML).find("Field[DisplayName='"+aq.lookupColumn+"']").each(function(){ar=Q(this).attr("StaticName");Q().SPServices({operation:"GetList",async:false,listName:Q(this).attr("List"),completefunc:function(ay,ax){Q(ay.responseXML).find("List").each(function(){t=Q(this).attr("WebFullUrl");t=t!==k?t+k:t})}});at=u(Q(this).attr("List"),"NewForm");return false})}});if(t.length===0&&aq.debug){N(au,"lookupColumn: "+aq.lookupColumn,"This column does not appear to be a lookup column");return}if(at.length>0){var i=t+at;i+=aq.newWindow?((aq.ContentTypeID.length>0)?"?ContentTypeID="+aq.ContentTypeID:"")+"' target='_blank'":"?"+((aq.ContentTypeID.length>0)?"ContentTypeID="+aq.ContentTypeID+"&":"")+"Source="+al(location.href)+"'";newLink="<div id='SPLookupAddNew_"+ar+"'><a href='"+i+">"+aq.promptText.replace(/\{0\}/g,aq.lookupColumn)+"</a></div>";Q(ao.Obj).parents("td.ms-formbody").append(newLink)}else{if(aq.debug){N(au,"lookupColumn: "+aq.lookupColumn,"NewForm cannot be found");return}}if(aq.completefunc!==null){aq.completefunc()}};Q.fn.SPServices.SPGetLastItemId=function(t){var ap=Q.extend({},{webURL:"",listName:"",userAccount:"",CAMLQuery:""},t);var ao;var aq=0;Q().SPServices({operation:"GetUserInfo",async:false,userLoginName:(ap.userAccount!=="")?ap.userAccount:Q().SPServices.SPGetCurrentUser(),completefunc:function(at,ar){Q(at.responseXML).find("User").each(function(){ao=Q(this).attr("ID")})}});var i="<Query><Where>";if(ap.CAMLQuery.length>0){i+="<And>"}i+="<Eq><FieldRef Name='Author' LookupId='TRUE'/><Value Type='Integer'>"+ao+"</Value></Eq>";if(ap.CAMLQuery.length>0){i+=ap.CAMLQuery+"</And>"}i+="</Where><OrderBy><FieldRef Name='Created_x0020_Date' Ascending='FALSE'/></OrderBy></Query>";Q().SPServices({operation:"GetListItems",async:false,webURL:ap.webURL,listName:ap.listName,CAMLQuery:i,CAMLViewFields:"<ViewFields><FieldRef Name='ID'/></ViewFields>",CAMLRowLimit:1,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(at,ar){Q(at.responseXML).SPFilterNode("z:row").each(function(){aq=Q(this).attr("ows_ID")})}});return aq};Q.fn.SPServices.SPRequireUnique=function(av){var i=Q.extend({},{columnStaticName:"Title",duplicateAction:0,ignoreCase:false,initMsg:"This value must be unique.",initMsgCSSClass:"ms-vb",errMsg:"This value is not unique.",errMsgCSSClass:"ms-formvalidation",showDupes:false,completefunc:null},av);var ao=Q().SPServices.SPGetQueryString();var at=ao.ID;var ar=Q().SPServices.SPListNameFromUrl();var t="<span id='SPRequireUnique"+i.columnStaticName+"' class='{0}'>{1}</span><br/>";var aq=t.replace(/\{0\}/g,i.initMsgCSSClass).replace(/\{1\}/g,i.initMsg);var ap=Q().SPServices.SPGetDisplayFromStatic({listName:ar,columnStaticName:i.columnStaticName});var au=Q("input[Title='"+ap+"']");Q(au).parent().append(aq);Q(au).blur(function(){var ay=[];var az=Q(this).attr("value");if(az.length===0){return false}Q().SPServices({operation:"GetListItems",async:false,listName:ar,CAMLQuery:"<Query><Where><IsNotNull><FieldRef Name='"+i.columnStaticName+"'/></IsNotNull></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='ID' /><FieldRef Name='"+i.columnStaticName+"' /></ViewFields>",CAMLRowLimit:0,completefunc:function(aC,aA){var aB=i.ignoreCase?az.toUpperCase():az;Q(aC.responseXML).SPFilterNode("z:row").each(function(){var aD=i.ignoreCase?Q(this).attr("ows_"+i.columnStaticName).toUpperCase():Q(this).attr("ows_"+i.columnStaticName);if((aB===aD)&&(Q(this).attr("ows_ID")!==at)){ay.push([Q(this).attr("ows_ID"),Q(this).attr("ows_"+i.columnStaticName)])}})}});var ax=i.initMsg;Q("span#SPRequireUnique"+i.columnStaticName).html(ax).attr("class",i.initMsgCSSClass);Q("input[value='OK']:disabled, input[value='Save']:disabled").removeAttr("disabled");if(ay.length>0){ax=i.errMsg;Q("span#SPRequireUnique"+i.columnStaticName).html(ax).attr("class",i.errMsgCSSClass);if(i.duplicateAction===1){Q("input[Title='"+i.columnDisplayName+"']").focus();Q("input[value='OK'], input[value='Save']").attr("disabled","disabled")}if(i.showDupes){var aw=" "+ay.length+" duplicate item"+(ay.length>1?"s":"")+": ";for(aj=0;aj<ay.length;aj++){aw+="<a href='DispForm.aspx?ID="+ay[aj][0]+"&Source="+location.href+"'>"+ay[aj][1]+"</a> "}Q("span#SPRequireUnique"+i.columnStaticName).append(aw)}}});if(i.completefunc!==null){i.completefunc()}};Q.fn.SPServices.SPGetDisplayFromStatic=function(t){var ao=Q.extend({},{webURL:"",listName:"",columnStaticName:""},t);var i="";Q().SPServices({operation:"GetList",async:false,webURL:ao.webURL,listName:ao.listName,completefunc:function(aq,ap){Q(aq.responseXML).find("Field[StaticName='"+ao.columnStaticName+"']").each(function(){i=Q(this).attr("DisplayName");return false})}});return i};Q.fn.SPServices.SPGetStaticFromDisplay=function(i){var ao=Q.extend({},{webURL:"",listName:"",columnDisplayName:""},i);var t="";Q().SPServices({operation:"GetList",async:false,webURL:ao.webURL,listName:ao.listName,completefunc:function(aq,ap){Q(aq.responseXML).find("Field[DisplayName='"+ao.columnDisplayName+"']").each(function(){t=Q(this).attr("StaticName");return false})}});return t};Q.fn.SPServices.SPRedirectWithID=function(av){var i=Q.extend({},{redirectUrl:"",qsParamName:"ID"},av);var at=Q().SPServices.SPListNameFromUrl();var t=Q().SPServices.SPGetQueryString();var ap=t.ID;var aq=t.List;var au=t.RootFolder;var ar=t.ContentTypeId;if(typeof t.ID==="undefined"){ap=Q().SPServices.SPGetLastItemId({listName:at});Q("form[name='aspnetForm']").each(function(){var ax=(location.href.indexOf("?")>0)?location.href.substring(0,location.href.indexOf("?")):location.href;var ay=(typeof t.Source==="string")?"Source="+t.Source.replace(/\//g,"%2f").replace(/:/g,"%3a"):"";var aw=[];if(typeof aq!=="undefined"){aw.push("List="+aq)}if(typeof au!=="undefined"){aw.push("RootFolder="+au)}if(typeof ar!=="undefined"){aw.push("ContentTypeId="+ar)}var az=ax+((aw.length>0)?("?"+aw.join("&")+"&"):"?")+"Source="+ax+"?ID="+ap+((ay.length>0)?("%26RealSource="+t.Source):"")+((typeof t.RedirectURL==="string")?("%26RedirectURL="+t.RedirectURL):"");Q(this).attr("action",az)})}else{while(t.ID===ap){ap=Q().SPServices.SPGetLastItemId({listName:at})}var ao=(typeof t.RedirectURL==="string")?t.RedirectURL:i.redirectUrl;location.href=ao+"?"+i.qsParamName+"="+ap+((typeof t.RealSource==="string")?("&Source="+t.RealSource):"")}};Q.fn.SPServices.SPSetMultiSelectSizes=function(av){var i=Q.extend({},{multiSelectColumn:"",minWidth:0,maxWidth:0},av);var aq=Q("select[ID$='SelectCandidate'][Title^='"+i.multiSelectColumn+" ']");var at=aq.closest("span").find("select[ID$='SelectResult'][Title^='"+i.multiSelectColumn+" ']");var ar=m("SPSetMultiSelectSizes",i.multiSelectColumn);aq.clone().appendTo(aq.closest("span")).css({width:"auto",height:0,visibility:"hidden"}).attr({id:ar,length:0});var ap=Q("#"+ar);aq.find("option").each(function(){ap.append("<option value='"+Q(this).html()+"'>"+Q(this).html()+"</option>")});at.find("option").each(function(){ap.append("<option value='"+Q(this).html()+"'>"+Q(this).html()+"</option>")});var t=Q("#"+ar).width()+5;var au=t;if(i.minWidth>0||i.maxWidth>0){if(t<i.minWidth){t=i.minWidth}if(au<i.minWidth){au=i.minWidth}if(au>i.maxWidth){au=i.maxWidth}}var ao=t;aq.css("width",ao+"px").parent().css("width",au+"px");at.css("width",ao+"px").parent().css("width",au+"px");Q("#"+ar).remove()};Q.fn.SPServices.SPScriptAudit=function(ao){var ap=Q.extend({},{webURL:"",listName:"",outputId:"",auditForms:true,auditViews:true,auditPages:true,auditPagesListName:"Pages",showHiddenLists:false,showNoScript:false,showSrc:true},ao);var t=[["New","NewForm.aspx",false],["Display","DispForm.aspx",false],["Edit","EditForm.aspx",false]];var aq;Q("#"+ap.outputId).append("<table id='SPScriptAudit' width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1><tr><th></th><th>List</th><th>Page Class</th><th>Page Type</th><th>Page</th>"+(ap.showSrc?"<th>Script References</th>":"")+"</tr></table>");Q("#SPScriptAudit th").attr("class","ms-vh2-nofilter");if(ap.auditForms||ap.auditViews){Q().SPServices({operation:"GetListCollection",webURL:ap.webURL,async:false,completefunc:function(au,at){Q(au.responseXML).find("List").each(function(){aq=Q(this);if((ap.listName.length===0)||(aq.attr("Title")===ap.listName)){if((ap.showHiddenLists&&aq.attr("Hidden")==="False")||!ap.showHiddenLists){if(ap.auditForms){Q().SPServices({operation:"GetListContentTypes",webURL:ap.webURL,listName:aq.attr("ID"),async:false,completefunc:function(aw,av){Q(aw.responseXML).find("ContentType").each(function(){if(Q(this).attr("ID").substring(0,6)!=="0x0120"){var ay=Q(this).find("FormUrls");for(aj=0;aj<t.length;aj++){Q(ay).find(t[aj][0]).each(function(){o(ap,aq,"Form",this.nodeName,((ap.webURL.length>0)?ap.webURL:Q().SPServices.SPGetCurrentSite())+k+Q(this).text());t[aj][2]=true});if(!t[aj][2]){var ax=aq.attr("DefaultViewUrl");o(ap,aq,"Form",t[aj][0],ax.substring(0,ax.lastIndexOf(k)+1)+t[aj][1])}}for(aj=0;aj<t.length;aj++){t[aj][2]=false}}})}})}if(ap.auditViews){Q().SPServices({operation:"GetViewCollection",webURL:ap.webURL,listName:aq.attr("ID"),async:false,completefunc:function(aw,av){Q(aw.responseXML).find("View").each(function(){o(ap,aq,"View",Q(this).attr("DisplayName"),Q(this).attr("Url"))})}})}}}})}})}var i=0;var ar=[];if(typeof ap.auditPagesListName==="string"){i=1;ar.push(ap.auditPagesListName)}else{i=ap.auditPagesListName.length;ar=ap.auditPagesListName}if(ap.auditPages){for(aj=0;aj<i;aj++){Q().SPServices({operation:"GetList",async:false,webURL:ap.webURL,listName:ar[aj],completefunc:function(au,at){Q(au.responseXML).find("List").each(function(){aq=Q(this)})}});Q().SPServices({operation:"GetListItems",async:false,webURL:ap.webURL,listName:ar[aj],CAMLQuery:"<Query><Where><Neq><FieldRef Name='ContentType'/><Value Type='Text'>Folder</Value></Neq></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='Title'/><FieldRef Name='FileRef'/></ViewFields>",CAMLRowLimit:0,completefunc:function(au,at){Q(au.responseXML).SPFilterNode("z:row").each(function(){var aw=Q(this).attr("ows_FileRef").split(";#")[1];var av=(typeof Q(this).attr("ows_Title")!=="undefined")?Q(this).attr("ows_Title"):"";if(aw.indexOf(".aspx")>0){o(ap,aq,"Page",av,k+aw)}})}})}}Q("#SPScriptAudit tr[class='ms-alternating']:even").removeAttr("class")};function o(t,ao,aw,ar,ap){var at=0;var av=0;var aq={};aq.type=[];aq.src=[];aq.script=[];var au=RegExp("<script[\\s\\S]*?/script>","gi");Q.ajax({type:"GET",url:ap,dataType:"text",async:false,success:function(aB){while(scriptMatch=au.exec(aB)){var ax=M(scriptMatch,"language");var aC=M(scriptMatch,"type");var az=M(scriptMatch,"src");if(az!==null&&az.length>0&&!R(az)){aq.type.push((ax!==null&&ax.length>0)?ax:aC);aq.src.push(az);av++}}if((!t.showNoScript&&(aq.type.length>0))||t.showNoScript){var aA=ap.substring(0,ap.lastIndexOf(k)+1);var ay="<tr class=ms-alternating><td class=ms-vb-icon><a href='"+ao.attr("DefaultViewUrl")+"'><IMG border=0 src='"+ao.attr("ImageUrl")+"'width=16 height=16></A></TD><td class=ms-vb2><a href='"+ao.attr("DefaultViewUrl")+"'>"+ao.attr("Title")+((ao.attr("Hidden")==="True")?"(Hidden)":"")+"</td><td class=ms-vb2>"+aw+"</td><td class=ms-vb2>"+ar+"</td><td class=ms-vb2><a href='"+ap+"'>"+G(ap)+"</td>";if(t.showSrc){var i;ay+="<td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>";for(at=0;at<aq.type.length;at++){i=(aq.src[at].substr(0,1)!==k)?aA+aq.src[at]:aq.src[at];ay+="<tr><td class=ms-vb2 width='30%'>"+aq.type[at]+"</td>";ay+="<td class=ms-vb2 width='70%'><a href='"+i+"'>"+G(aq.src[at])+"</td></tr>"}ay+="</table></td>"}Q("#SPScriptAudit").append(ay)}}})}function M(ao,t){var i=RegExp(t+"=(\"([^\"]*)\")|('([^']*)')","gi");if(matches=i.exec(ao)){return matches[2]}return null}function R(ap){var ao;var t=["WebResource.axd","_layouts"];for(ao=0;ao<t.length;ao++){if(ap.indexOf(t[ao])>-1){return true}}return false}Q.fn.SPServices.SPArrangeChoices=function(aw){var t=Q.extend({},{listName:"",columnName:"",perRow:99,randomize:false},aw);var ar=false;var at=[];var ap;Q().SPServices({operation:"GetList",async:false,listName:(t.listName.length>0)?t.listName:Q().SPServices.SPListNameFromUrl(),completefunc:function(ay,ax){Q(ay.responseXML).find("Fields").each(function(){Q(this).find("Field[DisplayName='"+t.columnName+"']").each(function(){ar=(Q(this).attr("FillInChoice")==="TRUE")?true:false;return false})})}});var ao=ag(t.columnName);var aq=Q(ao).find("tr").length;var au=0;var i;var av;Q(ao).find("tr").each(function(){au++;if(ar&&au===(aq-1)){i=Q(this).find("td").html()}else{if(ar&&au===aq){av=Q(this).find("td").html()}else{at.push(Q(this).html())}}});ap="<TR>";if(t.randomize){at.sort(ai)}for(aj=0;aj<at.length;aj++){ap+=at[aj];if((aj+1)%t.perRow===0){ap+="</TR><TR>"}}ap+="</TR>";if(ar){ap+="<TR><TD colspan='99'>"+i+av+"</TD></TR>"}Q(ao).find("tr").remove();Q(ao).find("table").append(ap)};Q.fn.SPServices.SPAutocomplete=function(ao){var ap=Q.extend({},{WebURL:"",sourceList:"",sourceColumn:"",columnName:"",CAMLQuery:"",CAMLQueryOptions:"<QueryOptions></QueryOptions>",CAMLRowLimit:0,filterType:"BeginsWith",numChars:0,ignoreCase:false,highlightClass:"",uniqueVals:false,maxHeight:99999,slideDownSpeed:"fast",processingIndicator:"_layouts/images/REFRESH.GIF",debug:false},ao);var ar;var t=Q("input[Title='"+ap.columnName+"']");Q("input[Title='"+ap.columnName+"']").css("position","");var at=t.attr("ID");var aq=t.css("color");var au=t.css("width");if(t.html()===null&&ap.debug){N("SPServices.SPAutocomplete","columnName: "+ap.columnName,"Column is not an input control or is not found on page");return}t.closest("span").find("br").remove();t.wrap("<div>");var i=m("SPAutocomplete",ap.columnName);t.after("<div><ul id='"+i+"' style='width:"+au+";display:none;padding:2px;border:1px solid #2A1FAA;background-color:#FFF;position:absolute;z-index:40;margin:0'></div>");Q("#"+i).css("width",au);Q(t).keyup(function(){var aD=Q(this).val();Q("#"+i).hide();if(aD.length<ap.numChars){return false}t.css({"background-image":"url("+ap.processingIndicator+")","background-position":"right","background-repeat":"no-repeat"});var aC=[];var av="<Query><OrderBy><FieldRef Name='"+ap.sourceColumn+"'/></OrderBy><Where>";if(ap.CAMLQuery.length>0){av+="<And>"}av+="<"+ap.filterType+"><FieldRef Name='"+ap.sourceColumn+"'/><Value Type='Text'>"+aD+"</Value></"+ap.filterType+">";if(ap.CAMLQuery.length>0){av+=ap.CAMLQuery+"</And>"}av+="</Where></Query>";Q().SPServices({operation:"GetListItems",async:false,webURL:ap.WebURL,listName:ap.sourceList,CAMLQuery:av,CAMLQueryOptions:ap.CAMLQueryOptions,CAMLViewFields:"<ViewFields><FieldRef Name='"+ap.sourceColumn+"' /></ViewFields>",CAMLRowLimit:ap.CAMLRowLimit,completefunc:function(aH,aF){var aG=ap.ignoreCase?aD.toUpperCase():aD;Q(aH.responseXML).SPFilterNode("z:row").each(function(){var aJ=Q(this).attr("ows_"+ap.sourceColumn);var aK=ap.ignoreCase?Q(this).attr("ows_"+ap.sourceColumn).toUpperCase():Q(this).attr("ows_"+ap.sourceColumn);if(ap.filterType==="Contains"){var aI=aK.indexOf(aG);if((aI>=0)&&(!ap.uniqueVals||(Q.inArray(aJ,aC)===-1))){aC.push(Q(this).attr("ows_"+ap.sourceColumn))}}else{if(aG===aK.substr(0,aG.length)&&(!ap.uniqueVals||(Q.inArray(aJ,aC)===-1))){aC.push(Q(this).attr("ows_"+ap.sourceColumn))}}})}});var ay="";for(aj=0;aj<aC.length;aj++){if(ap.highlightClass.length>0){var ax=RegExp(aD,ap.ignoreCase?"gi":"g");var aA=aC[aj].match(ax);var az=0;for(ar=0;ar<aA.length;ar++){var aB=aC[aj].indexOf(aA[ar],az);var aw=aB+aA[ar].length;var aE="<span class='"+ap.highlightClass+"'>"+aA[ar]+"</span>";aC[aj]=aC[aj].substr(0,aB)+aE+aC[aj].substr(aw);az=aB+aE.length}}ay+="<li style='display: block;position: relative;cursor: pointer;'>"+aC[aj]+"</li>"}Q("#"+i).html(ay);Q("#"+i+" li").click(function(){Q("#"+i).fadeOut(ap.slideUpSpeed);Q("#"+at).val(Q(this).text())}).mouseover(function(){var aF={cursor:"hand",color:"#ffffff",background:"#3399ff"};Q(this).css(aF)}).mouseout(function(){var aF={cursor:"inherit",color:aq,background:"transparent"};Q(this).css(aF)});if(aC.length>0){Q("#"+i).slideDown(ap.slideDownSpeed)}t.css("background-image","")})};Q.fn.SPServices.SPGetQueryString=function(){var aq;var ar={};var t=location.search.substring(1,location.search.length);var ao=t.split("&");var ap=/^([^=]+)=(.*)/i;for(aq=0;aq<ao.length;aq++){matches=ap.exec(ao[aq]);if(ap.test(location.href)){if(matches!==null&&matches.length>2){ar[matches[1]]=unescape(matches[2]).replace("+"," ")}}}return ar};Q.fn.SPServices.SPListNameFromUrl=function(){if(x.length>0){return x}var t=location.href;var i=t.substring(0,t.indexOf(".aspx"));var ao=unescape(i.substring(0,i.lastIndexOf(k)+1)).toUpperCase();Q().SPServices({operation:"GetListCollection",async:false,completefunc:function(aq,ap){Q(aq.responseXML).find("List").each(function(){var ar=Q(this).attr("DefaultViewUrl");var at=ar.substring(0,ar.lastIndexOf(k)+1).toUpperCase();if(ao.indexOf(at)>0){x=Q(this).attr("ID");return false}})}});return x};Q.fn.SPServices.SPUpdateMultipleListItems=function(ap){var ar=Q.extend({},{webURL:"",listName:"",CAMLQuery:"",batchCmd:"Update",valuepairs:[],completefunc:null,debug:false},ap);var aq;var au=[];var at=[];Q().SPServices({operation:"GetListItems",async:false,webURL:ar.webURL,listName:ar.listName,CAMLQuery:ar.CAMLQuery,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(av,i){Q(av.responseXML).SPFilterNode("z:row").each(function(){au.push(Q(this).attr("ows_ID"));var aw=Q(this).attr("ows_FileRef");aw="/"+aw.substring(aw.indexOf(";#")+2);at.push(aw)})}});var t;var ao="<Batch OnError='Continue'>";for(aq=0;aq<au.length;aq++){ao+="<Method ID='"+aq+"' Cmd='"+ar.batchCmd+"'>";for(t=0;t<ar.valuepairs.length;t++){ao+="<Field Name='"+ar.valuepairs[t][0]+"'>"+B(ar.valuepairs[t][1])+"</Field>"}ao+="<Field Name='ID'>"+au[aq]+"</Field>";if(at[aq].length>0){ao+="<Field Name='FileRef'>"+at[aq]+"</Field>"}ao+="</Method>"}ao+="</Batch>";Q().SPServices({operation:"UpdateListItems",async:false,webURL:ar.webURL,listName:ar.listName,updates:ao,completefunc:function(av,i){if(ar.completefunc!==null){ar.completefunc(av,i)}}})};Q.fn.SPFilterNode=function(i){return this.find("*").filter(function(){return this.nodeName===i})};Q.fn.SPXmlToJson=function(t){var ap=Q.extend({},{mapping:{},includeAllAttrs:false,removeOws:true},t);var i;var ao=[];this.each(function(){var av={};var au;var ax=this.attributes;for(attrNum=0;attrNum<ax.length;attrNum++){var aw=ax[attrNum].name;var at=ap.mapping[aw];var aq=at!==undefined?at.mappedName:ap.removeOws?aw.split("ows_")[1]:aw;var ar=at!==undefined?at.objectType:undefined;if(ap.includeAllAttrs||at!==undefined){av[aq]=K(ax[attrNum].value,ar)}}ao.push(av)});return ao};function K(t,i){switch(i){case"DateTime":colValue=l(t);break;case"User":colValue=T(t);break;case"UserMulti":colValue=I(t);break;case"Lookup":colValue=c(t);break;case"LookupMulti":colValue=F(t);break;case"Boolean":colValue=y(t);break;case"Integer":colValue=h(t);break;case"Counter":colValue=h(t);break;case"MultiChoice":colValue=am(t);break;case"Currency":colValue=E(t);break;default:colValue=s(t);break}return colValue}function s(i){return i}function h(i){return parseInt(i,10)}function E(i){return parseFloat(i)}function y(t){var i=t==="0"?false:true;return i}function l(i){return new Date(i.replace(/-/g,"/"))}function T(t){if(t.length===0){return null}else{var i=t.split(";#");return{userId:i[0],userName:i[1]}}}function I(ao){if(ao.length===0){return null}else{var ap=[];var t=ao.split(";#");for(aj=0;aj<t.length;aj=aj+2){var i=T(t[aj]+";#"+t[aj+1]);ap.push(i)}return ap}}function c(i){if(i.length===0){return null}else{var t=i.split(";#");return{lookupId:t[0],lookupValue:t[1]}}}function F(t){if(t.length===0){return null}else{var ap=[];var i=t.split(";#");for(aj=0;aj<i.length;aj=aj+2){var ao=c(i[aj]+";#"+i[aj+1]);ap.push(ao)}return ap}}function am(ao){if(ao.length===0){return null}else{var i=[];var t=ao.split(";#");for(aj=0;aj<t.length;aj++){if(t[aj].length!==0){i.push(t[aj])}}return i}}function D(ax,au,ay,ao){if(typeof ay==="undefined"){return""}var av;var aw;var at;var aq;var ap=ao.relatedWebURL.length>0?ao.relatedWebURL:Q().SPServices.SPGetCurrentSite();switch(au.attr("Type")){case"Text":aw=ay;break;case"URL":switch(au.attr("Format")){case"Hyperlink":aw="<a href='"+ay.substring(0,ay.search(","))+"'>"+ay.substring(ay.search(",")+1)+"</a>";break;case"Image":aw="<img alt='"+ay.substring(ay.search(",")+1)+"' src='"+ay.substring(0,ay.search(","))+"'/>";break;default:aw=ay;break}break;case"User":aw="<a href='/_layouts/userdisp.aspx?ID="+ay.substring(0,ay.search(";#"))+"&Source="+al(location.href)+"'>"+ay.substring(ay.search(";#")+2)+"</a>";break;case"Calculated":var ar=ay.split(";#");aw=ar[1];break;case"Number":aq=au.attr("Decimals");aw=aq===undefined?parseFloat(ay).toString():parseFloat(ay).toFixed(aq).toString();break;case"Currency":aq=au.attr("Decimals");aw=aq===undefined?parseFloat(ay).toFixed(2).toString():parseFloat(ay).toFixed(aq).toString();break;case"Lookup":switch(au.attr("Name")){case"FileRef":at=ax.attr("BaseType")==="1"?ax.attr("RootFolder")+k+"Forms/DispForm.aspx":ax.attr("RootFolder")+k+"DispForm.aspx";aw="<a href='"+at+"?ID="+ay.substring(0,ay.search(";#"))+"&RootFolder=*&Source="+al(location.href)+"'>"+ay.substring(ay.search(";#")+2)+"</a>";break;case"FileDirRef":at=k+ay.substring(ay.search(";#")+2);aw="<a href='"+at+"'>"+ay.substring(ay.search(";#")+2)+"</a>";break;default:at=u(au.attr("List"),"DisplayForm");aw="<a href='"+ao.relatedWebURL+k+at+"?ID="+ay.substring(0,ay.search(";#"))+"&RootFolder=*&Source="+al(location.href)+"'>"+ay.substring(ay.search(";#")+2)+"</a>";break}break;case"LookupMulti":at=u(au.attr("List"),"DisplayForm");aw="";if(ay.length>0){var t=ay.split(";#");for(av=0;av<t.length/2;av++){aw+="<a href='"+ap+k+at+"?ID="+t[av*2]+"&RootFolder=*&Source="+al(location.href)+"'>"+t[(av*2)+1]+"</a>";if(av<(t.length/2)-1){aw+=", "}}}break;case"File":G=ay.substring(ay.search(";#")+2);aw="<a href='"+ax.attr("RootFolder")+k+G+"'>"+G+"</a>";break;case"Counter":aw=ay;break;case"DateTime":aw=ay;break;default:aw=ay;break}return aw}function af(aq,ap){var ao;var t="<table class='ms-vb' width='100%'>";for(ao=0;ao<aq.attributes.length;ao++){t+="<tr><td width='10px' style='font-weight:bold;'>"+ao+"</td><td width='100px'>"+aq.attributes.item(ao).nodeName+"</td><td>"+A(aq.attributes.item(ao).nodeValue)+"</td></tr>"}t+="</table>";return t}function ad(i){if((this.Obj=Q("select[Title='"+i+"']")).html()!==null){this.Type="S"}else{if((this.Obj=Q("input[Title='"+i+"']")).html()!==null){this.Type="C"}else{if((this.Obj=Q("select[ID$='SelectCandidate'][Title^='"+i+" ']")).html()!==null){this.Type="M"}else{if((this.Obj=Q("select[ID$='SelectCandidate'][Title$=': "+i+"']")).html()!==null){this.Type="M"}else{if((this.Obj=Q("select[ID$='SelectCandidate'][Title$='\""+i+"\".']")).html()!==null){this.Type="M"}else{this.Type=null}}}}}}function S(ap,t){var i=[];switch(ap.Type){case"S":if(t){i.push(ap.Obj.find("option:selected").val()||[])}else{i.push(ap.Obj.find("option:selected").text()||[])}break;case"C":if(t){i.push(Q("input[id='"+ap.Obj.attr("optHid")+"']").val()||[])}else{i.push(ap.Obj.attr("value")||[])}break;case"M":var ao=ap.Obj.closest("td").next(":eq(4)").find("select[ID$='SelectResult']");Q(ao).find("option").each(function(){i.push(Q(this).html())});break;default:break}return i}function N(t,ap,ao){var i="<b>Error in function</b><br/>"+t+"<br/><b>Parameter</b><br/>"+ap+"<br/><b>Message</b><br/>"+ao+"<br/><br/><span onmouseover='this.style.cursor=\"hand\";' onmouseout='this.style.cursor=\"inherit\";' style='width=100%;text-align:right;'>Click to continue</span></div>";g(i)}function g(ar){var ao="position:absolute;width:300px;height:150px;padding:10px;background-color:#000000;color:#ffffff;z-index:30;font-family:'Arial';font-size:12px;display:none;";Q("#aspnetForm").parent().append("<div id='SPServices_msgBox' style="+ao+">"+ar);var i=Q("#SPServices_msgBox").height();var aq=Q("#SPServices_msgBox").width();var ap=(Q(window).width()/2)-(aq/2)+"px";var t=(Q(window).height()/2)-(i/2)-100+"px";Q("#SPServices_msgBox").css({border:"5px #C02000 solid",left:ap,top:t}).show().fadeTo("slow",0.75).click(function(){Q(this).fadeOut("3000",function(){Q(this).remove()})})}function m(i,t){return i+"_"+Q().SPServices.SPGetStaticFromDisplay({listName:Q().SPServices.SPListNameFromUrl(),columnDisplayName:t})}function u(i,ap){var ao,t;Q().SPServices({operation:"GetFormCollection",async:false,listName:i,completefunc:function(ar,aq){t=Q(ar.responseXML).find("Form[Type='"+ap+"']").attr("Url")}});return t}function j(ap,t){var ao;for(ao=0;ao<t.length;ao++){if(typeof t[ao]==="string"){O.payload+=H(t[ao],ap[t[ao]])}else{if(t[ao].length===2){O.payload+=H(t[ao][0],ap[t[ao][1]])}else{N(ap.operation,"paramArray["+ao+"]: "+t[ao],"Invalid paramArray element passed to addToPayload()")}}}}function ag(i){var ao;var t=RegExp('FieldName="'+i.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")+'"',"gi");Q("td.ms-formbody, td.ms-formbodysurvey").each(function(){if(t.test(Q(this).html())){ao=Q(this);return false}});return ao}function ae(i,ao){var t=ao.substring(8);i.opheader=i.opheader.replace(ao,t);i.opfooter=i.opfooter.replace(ao,t);return i}function H(ao,t){var i=t!==undefined?t:"";return"<"+ao+">"+i+"</"+ao+">"}function ai(){return(Math.round(Math.random())-0.5)}function A(i){return((i.indexOf("http")===0)||(i.indexOf(k)===0))?"<a href='"+i+"'>"+i+"</a>":i}function G(i){return i.substring(i.lastIndexOf(k)+1,i.length)}function a(i){return i.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function B(i){if(typeof i==="string"){return i.replace(/&(?![a-zA-Z]{1,8};)/g,"&amp;")}else{return i}}function al(i){return i.replace(/&/g,"%26")}})(jQuery);
